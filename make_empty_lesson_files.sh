#!/usr/bin/env bash
set -euo pipefail

# ###############################
# ðŸ“ lessons í´ë” ìƒì„±
# ###############################
echo "ðŸš€ JavaScript ë ˆìŠ¨ íŒŒì¼ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‹œìž‘..."
echo ""

# lessons í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±
if [ ! -d "lessons" ]; then
    echo "ðŸ“ lessons í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤..."
    mkdir -p lessons
else
    echo "âœ… lessons í´ë”ê°€ ì´ë¯¸ ì¡´ìž¬í•©ë‹ˆë‹¤."
fi

echo ""

# ###############################
# ðŸ“ ë ˆìŠ¨ íŒŒì¼ ìƒì„± (lesson01.js ~ lesson30.js)
# ###############################
echo "ðŸ“ ë ˆìŠ¨ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤..."
echo ""

created_count=0
skipped_count=0

for i in $(seq 1 30); do
    # ìˆ«ìžë¥¼ ë‘ ìžë¦¬ë¡œ í¬ë§·íŒ… (01, 02, ..., 30)
    lesson_num=$(printf "%02d" $i)
    filename="lessons/lesson${lesson_num}.js"

    # íŒŒì¼ì´ ì´ë¯¸ ì¡´ìž¬í•˜ëŠ”ì§€ í™•ì¸
    if [ -f "$filename" ]; then
        echo "â­ï¸  $filename - ì´ë¯¸ ì¡´ìž¬í•©ë‹ˆë‹¤. ê±´ë„ˆëœë‹ˆë‹¤."
        ((skipped_count++))
    else
        # íŒŒì¼ ìƒì„± ë° ê¸°ë³¸ í…œí”Œë¦¿ ìž‘ì„±
        cat > "$filename" << 'EOF'
// ===============================
// ë ˆìŠ¨ ì‹¤í–‰ í•¨ìˆ˜
// ===============================

function run() {
    console.log('ë ˆìŠ¨ì„ ì‹œìž‘í•©ë‹ˆë‹¤...');
    console.log('');

    // =============================
    // ì—¬ê¸°ì— ë ˆìŠ¨ ì½”ë“œë¥¼ ìž‘ì„±í•˜ì„¸ìš”
    // =============================

    console.log('TODO: ë ˆìŠ¨ ë‚´ìš©ì„ êµ¬í˜„í•´ì£¼ì„¸ìš”.');

    console.log('');
    console.log('ë ˆìŠ¨ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!');
}

// ===============================
// ëª¨ë“ˆ ë‚´ë³´ë‚´ê¸°
// ===============================
module.exports = { run };
EOF
        echo "âœ… $filename - ìƒì„± ì™„ë£Œ!"
        ((created_count++))
    fi
done

echo ""
echo "======================================"
echo "ðŸ“Š ë ˆìŠ¨ íŒŒì¼ ìƒì„± ê²°ê³¼"
echo "======================================"
echo "âœ… ìƒˆë¡œ ìƒì„±ëœ íŒŒì¼: ${created_count}ê°œ"
echo "â­ï¸  ê±´ë„ˆë›´ íŒŒì¼: ${skipped_count}ê°œ"
echo "ðŸ“ ì´ íŒŒì¼ ìˆ˜: 30ê°œ"
echo "======================================"
echo ""
echo "ðŸŽ‰ ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"